{
  "version": 4,
  "terraform_version": "1.9.7",
  "serial": 0,
  "lineage": "",
  "outputs": {},
  "resources": [
    {
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].connectivity",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "d99993e0-8770-427f-b49d-6a536d589392",
            "id": "2024-10-05 19:26:28.075099247 +0000 UTC",
            "object_id": "b027b49a-d47d-4dbb-8518-554223cd8bbe",
            "subscription_id": "96b73036-7cc0-4f2f-a24c-100e1d9836ca",
            "tenant_id": "af8838c9-b366-4dd8-9820-7b88df50eaab",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "d99993e0-8770-427f-b49d-6a536d589392",
            "id": "2024-10-05 19:26:22.945892123 +0000 UTC",
            "object_id": "b027b49a-d47d-4dbb-8518-554223cd8bbe",
            "subscription_id": "96b73036-7cc0-4f2f-a24c-100e1d9836ca",
            "tenant_id": "af8838c9-b366-4dd8-9820-7b88df50eaab",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "management",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"].management",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "d99993e0-8770-427f-b49d-6a536d589392",
            "id": "2024-10-05 19:26:28.163446124 +0000 UTC",
            "object_id": "b027b49a-d47d-4dbb-8518-554223cd8bbe",
            "subscription_id": "96b73036-7cc0-4f2f-a24c-100e1d9836ca",
            "tenant_id": "af8838c9-b366-4dd8-9820-7b88df50eaab",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "data",
      "type": "azurerm_policy_definition",
      "name": "external_lookup",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
          "schema_version": 0,
          "attributes": {
            "description": "Enable the private cluster feature for your Azure Kubernetes Service cluster to ensure network traffic between your API server and your node pools remains on the private network only. This is a common requirement in many regulatory and industry compliance standards.",
            "display_name": "Azure Kubernetes Service Private Clusters should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"1.0.1\"}",
            "name": "040732e8-d947-40b8-95d6-854c95024bf8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},{\"field\":\"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.enablePrivateCluster\",\"notEquals\":true}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Service Bus to stream to a regional Log Analytics workspace when any Service Bus which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Service Bus to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.0\"}",
            "name": "04d53d87-841c-4f23-8a5b-21564380b55e",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ServiceBus/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"OperationalLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"VNetAndIPFilteringLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RuntimeAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationMetricsLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ServiceBus/namespaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
          "schema_version": 0,
          "attributes": {
            "description": "Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys.",
            "display_name": "Azure API for FHIR should use a customer-managed key to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"API for FHIR\",\"version\":\"1.1.0\"}",
            "name": "051cba44-2429-45b9-9649-46cec11c7119",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HealthcareApis/services\",\"field\":\"type\"},{\"exists\":\"false\",\"field\":\"Microsoft.HealthcareApis/services/cosmosDbConfiguration.keyVaultKeyUri\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Linux VMs if the VM Image (OS) is in the list defined and the extension is not installed. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date",
            "display_name": "Deploy Log Analytics extension for Linux VMs. See deprecation notice below",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.0\"}",
            "name": "053d3325-282c-4e5c-b944-24faffd30d77",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"15*\"}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"UbuntuServer\",\"0001-com-ubuntu-server-focal\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts-gen2\"}]}]},{\"allOf\":[{\"equals\":\"credativ\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Debian\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"9*\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"OMSAgentForLinux\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"OmsAgentForLinux\",\"vmExtensionTypeHandlerVersion\":\"1.13\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
          "schema_version": 0,
          "attributes": {
            "description": "To access the private endpoint(s) for Storage Sync Service resource interfaces from a registered server, you need to configure your DNS to resolve the correct names to your private endpoint's private IP addresses. This policy creates the requisite Azure Private DNS Zone and A records for the interfaces of your Storage Sync Service private endpoint(s).",
            "display_name": "Configure Azure File Sync to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.1.0\"}",
            "name": "06695360-db88-47f6-b976-7500d4297475",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"privateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"afs\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-afs\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f\",\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Windows virtual machines if the virtual machine image is in the list defined and the extension is not installed. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.",
            "display_name": "Deploy - Configure Log Analytics extension to be enabled on Windows virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.1.0\"}",
            "name": "0868462e-646c-4fe3-9ced-a733534b6a2c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example values: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Log Analytics workspace is used to receive performance data. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\",\"2022-datacenter\",\"2022-datacenter-g2\",\"2022-datacenter-smalldisk\",\"2022-datacenter-smalldisk-g2\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"MicrosoftMonitoringAgent\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"MicrosoftMonitoringAgent\",\"vmExtensionTypeHandlerVersion\":\"1.0\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Search Services to stream to a regional Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Search Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "08ba64b8-738f-4918-9686-730d2ed79c7d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Search/searchServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"OperationLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Search/searchServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
          "schema_version": 0,
          "attributes": {
            "description": "This policy definition is no longer the recommended way to achieve its intent. Instead of continuing to use this policy, we recommend you assign this replacement policies with policy IDs 3dc5edcd-002d-444c-b216-e123bbfa37c0 and ca88aadc-6e2b-416c-9de2-5a0f01d1693f. Learn more about policy definition deprecation at aka.ms/policydefdeprecation",
            "display_name": "[Deprecated]: Virtual machines should encrypt temp disks, caches, and data flows between Compute and Storage resources",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"deprecated\":true,\"version\":\"2.1.0-deprecated\"}",
            "name": "0961003e-5a0a-4549-abde-af6a37f2724d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.ClassicCompute/virtualMachines\",\"Microsoft.Compute/virtualMachines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"d57a4221-a804-52ca-3dea-768284f06bb7\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Web PubSub service. Learn more at: https://aka.ms/awps/privatelink.",
            "display_name": "Configure Azure Web PubSub Service to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Web PubSub\",\"version\":\"1.0.0\"}",
            "name": "0b026355-49cb-467b-8ac4-f777874e175a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Private DNS zone to integrate with private endpoint.\",\"displayName\":\"Private DNS Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"webpubsub\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-webpubsub-azure-com\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd",
          "schema_version": 0,
          "attributes": {
            "description": "This policy is deprecated. Please use /providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8 instead.",
            "display_name": "[Deprecated]: SQL servers should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"deprecated\":true,\"version\":\"2.0.1-deprecated\"}",
            "name": "0d134df8-db83-46fb-ad72-fe0c9428c8dd",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"AzureKeyVault\",\"field\":\"Microsoft.Sql/servers/encryptionProtector/serverKeyType\"},{\"field\":\"Microsoft.Sql/servers/encryptionProtector/uri\",\"notEquals\":\"\"},{\"exists\":\"true\",\"field\":\"Microsoft.Sql/servers/encryptionProtector/uri\"}]},\"name\":\"current\",\"type\":\"Microsoft.Sql/servers/encryptionProtector\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that container registries are not exposed on the public internet. Creating private endpoints can limit exposure of container registry resources. Learn more at: https://aka.ms/acr/portal/public-network and https://aka.ms/acr/private-link.",
            "display_name": "Public network access should be disabled for Container registries",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"1.0.0\"}",
            "name": "0fdf0491-d080-4575-b627-ad0e843cba0f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},{\"field\":\"Microsoft.ContainerRegistry/registries/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machines as non-compliant if the virtual machine image is not in the list defined and the agent is not installed. The list of OS images is updated over time as support is updated.",
            "display_name": "Dependency agent should be enabled for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "11ac78e3-31bc-4f0c-8434-37ab963cea07",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"Centos\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.",
            "display_name": "PostgreSQL servers should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.4\"}",
            "name": "18adea5e-f416-4d0f-8aa8-d24321e3e274",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"AzureKeyVault\",\"field\":\"Microsoft.DBforPostgreSQL/servers/keys/serverKeyType\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/keys/uri\",\"notEquals\":\"\"},{\"exists\":\"true\",\"field\":\"Microsoft.DBforPostgreSQL/servers/keys/uri\"}]},\"type\":\"Microsoft.DBforPostgreSQL/servers/keys\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures authentication and protects data in transit from network layer eavesdropping attacks. This capability is currently generally available for Kubernetes Service (AKS), and in preview for Azure Arc enabled Kubernetes. For more info, visit https://aka.ms/kubepolicydoc",
            "display_name": "Kubernetes clusters should be accessible only over HTTPS",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"8.2.0\"}",
            "name": "1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\",\"azure-extensions-usage-system\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design. \\\"azure-extensions-usage-system\\\" is optional to remove.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}},\"source\":{\"type\":\"String\",\"allowedValues\":[\"All\",\"Generated\",\"Original\"],\"defaultValue\":\"Original\",\"metadata\":{\"description\":\"The source k8s object for constraint evaluation. 'Original' means only evaluate against the specific GroupVersionKind specified in the policy definition. 'Generated' means only evaluate against k8s objects generated by Gatekeeper ExpansionTemplates. 'All' means evaluate against both the original object and any generated ones.\",\"displayName\":\"Source\"}},\"warn\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Whether or not to return warnings back to the user in the kubectl cli\",\"displayName\":\"Warn\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"extensions\",\"networking.k8s.io\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Ingress\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"source\":\"[parameters('source')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/ingress-https-only/v1/template.yaml\"},\"warn\":\"[parameters('warn')]\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public network access property improves security by ensuring your Azure SQL Database can only be accessed from a private endpoint. This configuration denies all logins that match IP or virtual network based firewall rules.",
            "display_name": "Public network access on Azure SQL Database should be disabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.1.0\"}",
            "name": "1b8ca024-1d5c-4dec-8995-b1a932b41780",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/servers/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Windows virtual machines if the virtual machine image is in the list defined and the agent is not installed.",
            "display_name": "Deploy - Configure Dependency agent to be enabled on Windows virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.2.0\"}",
            "name": "1c210e94-a481-4beb-95fa-1571b434fb04",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentWindows\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentWindows\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentWindows\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Event Hub to stream to a regional Log Analytics workspace when any Event Hub which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Event Hub to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "1f6e93e8-6b31-41b1-83f6-36e449a42579",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventHub/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ArchiveLogs\",\"enabled\":true,\"retentionPolicy\":{\"days\":0,\"enabled\":false}},{\"category\":\"OperationalLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AutoScaleLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"KafkaCoordinatorLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"KafkaUserErrorLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EventHubVNetConnectionEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"CustomerManagedKeyUserLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RuntimeAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationMetricsLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventHub/namespaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"anyOf\":[{\"allOf\":[{\"equals\":\"false\",\"value\":\"[parameters('logsEnabled')]\"},{\"equals\":\"false\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\"}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('logsEnabled')]\"},{\"anyOf\":[{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\",\"in\":[\"ArchiveLogs\",\"OperationalLogs\",\"AutoScaleLogs\",\"KafkaCoordinatorLogs\",\"KafkaUserErrorLogs\",\"EventHubVNetConnectionEvent\",\"CustomerManagedKeyUserLogs\",\"RuntimeAuditLogs\",\"ApplicationMetricsLogs\"]}]}},\"equals\":9},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"equals\":\"AllLogs\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].categoryGroup\"}]}},\"equals\":1}]}]}]},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/cosmosdb-cmk.",
            "display_name": "Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Cosmos DB\",\"version\":\"1.1.0\"}",
            "name": "1f905d99-2ab7-462c-a6b0-f709acca6c8f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"exists\":false,\"field\":\"Microsoft.DocumentDB/databaseAccounts/keyVaultKeyUri\"},{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public endpoint allows you to restrict access to your Storage Sync Service resource to requests destined to approved private endpoints on your organization's network. There is nothing inherently insecure about allowing requests to the public endpoint, however, you may wish to disable it to meet regulatory, legal, or organizational policy requirements. You can disable the public endpoint for a Storage Sync Service by setting the incomingTrafficPolicy of the resource to AllowVirtualNetworksOnly.",
            "display_name": "Public network access should be disabled for Azure File Sync",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "name": "21a8cd35-125e-4d13-b82d-2e19b7208bb7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.StorageSync/storageSyncServices\",\"field\":\"type\"},{\"field\":\"Microsoft.StorageSync/storageSyncServices/incomingTrafficPolicy\",\"notEquals\":\"AllowVirtualNetworksOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Stream Analytics to stream to a regional Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.StreamAnalytics/streamingjobs\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Execution\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Authoring\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.StreamAnalytics/streamingjobs/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Activity to stream subscriptions audit logs to a Log Analytics workspace to monitor subscription-level events",
            "display_name": "Configure Azure Activity logs to stream to specified Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Primary Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"location\":\"Global\",\"name\":\"subscriptionToLa\",\"properties\":{\"logs\":[{\"category\":\"Administrative\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Security\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ServiceHealth\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Alert\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Recommendation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Policy\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Autoscale\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ResourceHealth\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Insights/diagnosticSettings\"}],\"variables\":{}}}},\"deploymentScope\":\"Subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"existenceScope\":\"Subscription\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machines as non-compliant if the virtual machine image is not in the list defined and the extension is not installed.",
            "display_name": "[Preview]: Log Analytics Extension should be enabled for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"preview\":true,\"version\":\"2.0.1-preview\"}",
            "name": "32133ab0-ee4b-4b44-98d6-042180979d50",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
          "schema_version": 0,
          "attributes": {
            "description": "Network access to storage accounts should be restricted. Configure network rules so only applications from allowed networks can access the storage account. To allow connections from specific internet or on-premises clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges",
            "display_name": "Storage accounts should restrict network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.1.1\"}",
            "name": "34c877ad-507e-4c82-993e-3452a6e0ad3c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Storage/storageAccounts/networkAcls.defaultAction\",\"notEquals\":\"Deny\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Azure Defender on your Azure SQL Servers to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
            "display_name": "Configure Azure Defender to be enabled on SQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.1.0\"}",
            "name": "36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"serverName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"serverName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-11-01-preview\",\"name\":\"[concat(parameters('serverName'), '/Default')]\",\"properties\":{\"state\":\"Enabled\"},\"type\":\"Microsoft.Sql/servers/securityAlertPolicies\"}],\"variables\":{}}}},\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/securityAlertPolicies.state\"},\"name\":\"Default\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/securityAlertPolicies\"},\"effect\":\"DeployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Windows virtual machine scale sets if the virtual machine image is in the list defined and the agent is not installed. If your scale set upgradePolicy is set to Manual, you need to apply the extension to all the virtual machines in the set by updating them.",
            "display_name": "Deploy - Configure Dependency agent to be enabled on Windows virtual machine scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.2.0\"}",
            "name": "3be22e3b-d919-47aa-805e-8985dbeb0ad9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentWindows\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentWindows\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentWindows\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Windows virtual machine scale sets if the virtual machine image is in the list defined and the extension is not installed. If your scale set upgradePolicy is set to Manual, you need to apply the extension to all the virtual machine in the set by updating them. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.",
            "display_name": "Deploy - Configure Log Analytics extension to be enabled on Windows virtual machine scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.1.0\"}",
            "name": "3c1b3629-c8f8-4bf6-862c-037cb9094038",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Log Analytics workspace is used to receive performance data. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\",\"2022-datacenter\",\"2022-datacenter-g2\",\"2022-datacenter-smalldisk\",\"2022-datacenter-smalldisk-g2\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"MicrosoftMonitoringAgent\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"MicrosoftMonitoringAgent\",\"vmExtensionTypeHandlerVersion\":\"1.0\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Linux virtual machines if the VM Image (OS) is in the list defined and the agent is not installed.",
            "display_name": "Deploy Dependency agent for Linux virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"5.1.0\"}",
            "name": "4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"0001-com-ubuntu-server-focal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"20_04-lts\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\",\"12-sp4-gen2\",\"12-SP5\",\"15\",\"15-SP1\"]}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp5*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"},{\"equals\":\"gen1\",\"field\":\"Microsoft.Compute/imageSKU\"}]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentLinux\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentLinux\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentLinux\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
          "schema_version": 0,
          "attributes": {
            "description": "Private DNS records allow private connections to private endpoints. Private endpoint connections allow secure communication by enabling private connectivity to Batch accounts without a need for public IP addresses at the source or destination. For more information on private endpoints and DNS zones in Batch, see https://docs.microsoft.com/azure/batch/private-connectivity.",
            "display_name": "Deploy - Configure private DNS zones for private endpoints that connect to Batch accounts",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Batch\",\"version\":\"1.0.0\"}",
            "name": "4ec38ebc-381f-45ee-81a4-acbc4be878f8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone to deploy in a new private DNS zone group and link to the private endpoint\",\"displayName\":\"Private DNS Zone\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"batchAccount\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"batchAccount-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
          "schema_version": 0,
          "attributes": {
            "description": "Enable the key vault firewall so that the key vault is not accessible by default to any public IPs. Optionally, you can configure specific IP ranges to limit access to those networks. Learn more at: https://docs.microsoft.com/azure/key-vault/general/network-security",
            "display_name": "Azure Key Vault should have firewall enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"3.2.1\"}",
            "name": "55615ac9-af46-4a59-874e-391cc3dfb490",
            "parameters": "{\"allowedIPAddresses\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Array with allowed public IP addresses. An empty array is evaluated as to allow all IPs.\",\"displayName\":\"Allowed IP addresses\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"forbiddenIPAddresses\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Array with forbidden public IP addresses. An empty array is evaluated as there are no forbidden IP addresses.\",\"displayName\":\"Forbidden IP addresses\"}},\"restrictIPAddresses\":{\"type\":\"String\",\"allowedValues\":[\"Yes\",\"No\"],\"defaultValue\":\"No\",\"metadata\":{\"description\":\"Select (Yes) to allow or forbid a list of IP addresses. If (No), the list of IP addresses won't have any effect in the policy enforcement\",\"displayName\":\"Would you like to restrict specific IP addresses?\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},{\"field\":\"Microsoft.KeyVault/vaults/createMode\",\"notEquals\":\"recover\"},{\"anyOf\":[{\"field\":\"Microsoft.KeyVault/vaults/networkAcls.defaultAction\",\"notEquals\":\"Deny\"},{\"allOf\":[{\"equals\":\"Yes\",\"value\":\"[parameters('restrictIPAddresses')]\"},{\"anyOf\":[{\"allOf\":[{\"count\":{\"name\":\"allowedIPAddresses\",\"value\":\"[parameters('allowedIPAddresses')]\"},\"notEquals\":0},{\"not\":{\"count\":{\"field\":\"Microsoft.KeyVault/vaults/networkAcls.ipRules[*]\",\"where\":{\"count\":{\"name\":\"allowedIpAddress\",\"value\":\"[parameters('allowedIPAddresses')]\",\"where\":{\"equals\":true,\"value\":\"[ipRangeContains(current('allowedIpAddress'), current('Microsoft.KeyVault/vaults/networkAcls.ipRules[*].value'))]\"}},\"greater\":0}},\"equals\":\"[length(field('Microsoft.KeyVault/vaults/networkAcls.ipRules[*]'))]\"}}]},{\"allOf\":[{\"count\":{\"name\":\"forbiddenIPAddresses\",\"value\":\"[parameters('forbiddenIPAddresses')]\"},\"notEquals\":0},{\"not\":{\"count\":{\"field\":\"Microsoft.KeyVault/vaults/networkAcls.ipRules[*]\",\"where\":{\"count\":{\"name\":\"forbiddenIPAddresses\",\"value\":\"[parameters('forbiddenIPAddresses')]\",\"where\":{\"equals\":true,\"value\":\"[ipRangeContains(current('forbiddenIPAddresses'), current('Microsoft.KeyVault/vaults/networkAcls.ipRules[*].value'))]\"}},\"greater\":0}},\"equals\":0}}]}]}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/acr/CMK.",
            "display_name": "Container registries should be encrypted with a customer-managed key",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"1.1.2\"}",
            "name": "5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},{\"field\":\"Microsoft.ContainerRegistry/registries/encryption.status\",\"notEquals\":\"enabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machine scale sets as non-compliant if the virtual machine image is not in the list defined and the extension is not installed.",
            "display_name": "Log Analytics extension should be enabled in virtual machine scale sets for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.1\"}",
            "name": "5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public network access property improves security by ensuring your Azure Database for PostgreSQL flexible servers can only be accessed from a private endpoint. This configuration strictly disables access from any public address space outside of Azure IP range and denies all logins that match IP based firewall rules.",
            "display_name": "Public network access should be disabled for PostgreSQL flexible servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"3.1.0\"}",
            "name": "5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/flexibleServers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.delegatedSubnetResourceId\"},{\"exists\":\"true\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.privateDnsZoneArmResourceId\"},{\"allOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.publicNetworkAccess\"},{\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.publicNetworkAccess\",\"notEquals\":\"Disabled\"}]}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.delegatedSubnetResourceId\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.privateDnsZoneArmResourceId\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Linux virtual machine scale sets if the VM Image (OS) is in the list defined and the extension is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances. Deprecation notice: The Log Analytics agent will not be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date",
            "display_name": "Deploy Log Analytics extension for Linux virtual machine scale sets. See deprecation notice below",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.0\"}",
            "name": "5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"15*\"}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"UbuntuServer\",\"0001-com-ubuntu-server-focal\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts-gen2\"}]}]},{\"allOf\":[{\"equals\":\"credativ\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Debian\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"9*\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"OMSAgentForLinux\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"OmsAgentForLinux\",\"vmExtensionTypeHandlerVersion\":\"1.13\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
          "schema_version": 0,
          "attributes": {
            "description": "Using customer-managed keys to encrypt data at rest provides more control over the key lifecycle, including rotation and management. This is particularly relevant for organizations with related compliance requirements. This is not assessed by default and should only be applied when required by compliance or restrictive policy requirements. If not enabled, the data will be encrypted using platform-managed keys. To implement this, update the 'Effect' parameter in the Security Policy for the applicable scope.",
            "display_name": "Azure AI Services resources should encrypt data at rest with a customer-managed key (CMK)",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Cognitive Services\",\"version\":\"2.2.0\"}",
            "name": "67121cc7-ff39-4ab8-b7e3-95b84dab487d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"excludedKinds\":{\"type\":\"Array\",\"defaultValue\":[\"CognitiveServices\",\"ContentSafety\",\"ImmersiveReader\",\"HealthInsights\",\"LUIS.Authoring\",\"LUIS\",\"QnAMaker\",\"QnAMaker.V2\",\"AIServices\",\"MetricsAdvisor\",\"SpeechTranslation\",\"Internal.AllInOne\",\"ConversationalLanguageUnderstanding\",\"knowledge\",\"TranscriptionIntelligence\",\"HealthDecisionSupport\"],\"metadata\":{\"description\":\"The list of excluded API kinds for customer-managed key, default is the list of API kinds that don't have data stored in Cognitive Services\",\"displayName\":\"Excluded Kinds\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},{\"field\":\"Microsoft.CognitiveServices/accounts/encryption.keySource\",\"notEquals\":\"Microsoft.KeyVault\"},{\"field\":\"kind\",\"notIn\":\"[parameters('excludedKinds')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Log Analytics virtual machine extension. VM insights uses the Log Analytics agent to collect the guest OS performance data, and provides insights into their performance. See more - https://aka.ms/vminsightsdocs. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.",
            "display_name": "Configure Log Analytics extension on Azure Arc enabled Windows servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.1\"}",
            "name": "69af7d4a-7b18-4044-93a9-2651498ef203",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the agent should be connected to. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"windows\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"MicrosoftMonitoringAgent\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"MicrosoftMonitoringAgent\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\",\"notEquals\":\"Failed\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Kubernetes Service to stream resource logs to a Log Analytics workspace.",
            "display_name": "Deploy - Configure diagnostic settings for Azure Kubernetes Service to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"3.0.0\"}",
            "name": "6c66c325-74c8-42fd-a286-a74b0e2939d8",
            "parameters": "{\"AllMetrics\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream AllMetrics logs to the Log Analytics workspace - True or False\",\"displayName\":\"AllMetrics - Enabled\"}},\"cloud-controller-manager\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream cloud-controller-manager logs to the Log Analytics workspace - True or False\",\"displayName\":\"cloud-controller-manager - Enabled\"}},\"cluster-autoscaler\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream cluster-autoscaler logs to the Log Analytics workspace - True or False\",\"displayName\":\"cluster-autoscaler - Enabled\"}},\"csi-azuredisk-controller\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream csi-azuredisk-controller logs to the Log Analytics workspace - True or False\",\"displayName\":\"csi-azuredisk-controller - Enabled\"}},\"csi-azurefile-controller\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream csi-azurefile-controller logs to the Log Analytics workspace - True or False\",\"displayName\":\"csi-azurefile-controller - Enabled\"}},\"csi-snapshot-controller\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream csi-snapshot-controller logs to the Log Analytics workspace - True or False\",\"displayName\":\"csi-snapshot-controller - Enabled\"}},\"diagnosticsSettingNameToUse\":{\"type\":\"String\",\"defaultValue\":\"AzureKubernetesDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"Name of the diagnostic settings.\",\"displayName\":\"Setting name\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"guard\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream guard logs to the Log Analytics workspace - True or False\",\"displayName\":\"guard - Enabled\"}},\"kube-apiserver\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-apiserver logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-apiserver - Enabled\"}},\"kube-audit\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-audit logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-audit - Enabled\"}},\"kube-audit-admin\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-audit-admin logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-audit-admin - Enabled\"}},\"kube-controller-manager\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-controller-manager logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-controller-manager - Enabled\"}},\"kube-scheduler\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-scheduler logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-scheduler - Enabled\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the Azure Kubernetes Service should be connected to\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"AllMetrics\":{\"value\":\"[parameters('AllMetrics')]\"},\"cloud-controller-manager\":{\"value\":\"[parameters('cloud-controller-manager')]\"},\"cluster-autoscaler\":{\"value\":\"[parameters('cluster-autoscaler')]\"},\"csi-azuredisk-controller\":{\"value\":\"[parameters('csi-azuredisk-controller')]\"},\"csi-azurefile-controller\":{\"value\":\"[parameters('csi-azurefile-controller')]\"},\"csi-snapshot-controller\":{\"value\":\"[parameters('csi-snapshot-controller')]\"},\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('diagnosticsSettingNameToUse')]\"},\"guard\":{\"value\":\"[parameters('guard')]\"},\"kube-apiserver\":{\"value\":\"[parameters('kube-apiserver')]\"},\"kube-audit\":{\"value\":\"[parameters('kube-audit')]\"},\"kube-audit-admin\":{\"value\":\"[parameters('kube-audit-admin')]\"},\"kube-controller-manager\":{\"value\":\"[parameters('kube-controller-manager')]\"},\"kube-scheduler\":{\"value\":\"[parameters('kube-scheduler')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"AllMetrics\":{\"type\":\"string\"},\"cloud-controller-manager\":{\"type\":\"string\"},\"cluster-autoscaler\":{\"type\":\"string\"},\"csi-azuredisk-controller\":{\"type\":\"string\"},\"csi-azurefile-controller\":{\"type\":\"string\"},\"csi-snapshot-controller\":{\"type\":\"string\"},\"diagnosticsSettingNameToUse\":{\"type\":\"string\"},\"guard\":{\"type\":\"string\"},\"kube-apiserver\":{\"type\":\"string\"},\"kube-audit\":{\"type\":\"string\"},\"kube-audit-admin\":{\"type\":\"string\"},\"kube-controller-manager\":{\"type\":\"string\"},\"kube-scheduler\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"kube-apiserver\",\"enabled\":\"[parameters('kube-apiserver')]\"},{\"category\":\"kube-audit\",\"enabled\":\"[parameters('kube-audit')]\"},{\"category\":\"kube-controller-manager\",\"enabled\":\"[parameters('kube-controller-manager')]\"},{\"category\":\"kube-scheduler\",\"enabled\":\"[parameters('kube-scheduler')]\"},{\"category\":\"cluster-autoscaler\",\"enabled\":\"[parameters('cluster-autoscaler')]\"},{\"category\":\"kube-audit-admin\",\"enabled\":\"[parameters('kube-audit-admin')]\"},{\"category\":\"guard\",\"enabled\":\"[parameters('guard')]\"},{\"category\":\"cloud-controller-manager\",\"enabled\":\"[parameters('cloud-controller-manager')]\"},{\"category\":\"csi-azuredisk-controller\",\"enabled\":\"[parameters('csi-azuredisk-controller')]\"},{\"category\":\"csi-azurefile-controller\",\"enabled\":\"[parameters('csi-azurefile-controller')]\"},{\"category\":\"csi-snapshot-controller\",\"enabled\":\"[parameters('csi-snapshot-controller')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('AllMetrics')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerService/managedClusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"count\":{\"name\":\"logCategoriesParameter\",\"value\":[{\"category\":\"kube-apiserver\",\"enabled\":\"[parameters('kube-apiserver')]\"},{\"category\":\"kube-audit\",\"enabled\":\"[parameters('kube-audit')]\"},{\"category\":\"kube-controller-manager\",\"enabled\":\"[parameters('kube-controller-manager')]\"},{\"category\":\"kube-scheduler\",\"enabled\":\"[parameters('kube-scheduler')]\"},{\"category\":\"cluster-autoscaler\",\"enabled\":\"[parameters('cluster-autoscaler')]\"},{\"category\":\"kube-audit-admin\",\"enabled\":\"[parameters('kube-audit-admin')]\"},{\"category\":\"guard\",\"enabled\":\"[parameters('guard')]\"},{\"category\":\"cloud-controller-manager\",\"enabled\":\"[parameters('cloud-controller-manager')]\"},{\"category\":\"csi-azuredisk-controller\",\"enabled\":\"[parameters('csi-azuredisk-controller')]\"},{\"category\":\"csi-azurefile-controller\",\"enabled\":\"[parameters('csi-azurefile-controller')]\"},{\"category\":\"csi-snapshot-controller\",\"enabled\":\"[parameters('csi-snapshot-controller')]\"}],\"where\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[current('logCategoriesParameter').enabled]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"equals\":\"[current('logCategoriesParameter').category]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"}]}},\"greater\":0}},\"equals\":11},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*]\",\"where\":{\"allOf\":[{\"equals\":\"AllMetrics\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('AllMetrics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]}},\"greater\":0},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6f8f98a4-f108-47cb-8e98-91a0d85cd474",
          "schema_version": 0,
          "attributes": {
            "description": "Deprecated: This policy did not evaluate correctly and has been separated into policies for each of the nested resources. Please see new policies for storage accounts (id: /providers/Microsoft.Authorization/policyDefinitions/59759c62-9a22-4cdf-ae64-074495983fef), blob services (b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb), file (25a70cc8-2bd4-47f1-90b6-1478e4662c96), queue (7bd000e3-37c7-4928-9f31-86c4b77c5c45), and table (2fb86bf3-d221-43d1-96d1-2434af34eaa0).",
            "display_name": "[Deprecated]: Configure diagnostic settings for storage accounts to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6f8f98a4-f108-47cb-8e98-91a0d85cd474",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"deprecated\":true,\"version\":\"1.3.0-deprecated\"}",
            "name": "6f8f98a4-f108-47cb-8e98-91a0d85cd474",
            "parameters": "{\"StorageDelete\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream StorageDelete logs to the Log Analytics workspace - True or False\",\"displayName\":\"StorageDelete - Enabled\"}},\"StorageRead\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream StorageRead logs to the Log Analytics workspace - True or False\",\"displayName\":\"StorageRead - Enabled\"}},\"StorageWrite\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream StorageWrite logs to the Log Analytics workspace - True or False\",\"displayName\":\"StorageWrite - Enabled\"}},\"Transaction\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Transaction logs to the Log Analytics workspace - True or False\",\"displayName\":\"Transaction - Enabled\"}},\"diagnosticsSettingNameToUse\":{\"type\":\"String\",\"defaultValue\":\"storageAccountsDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"Name of the diagnostic settings.\",\"displayName\":\"Setting name\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the storage account should be connected to.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"servicesToDeploy\":{\"type\":\"Array\",\"allowedValues\":[\"storageAccounts\",\"blobServices\",\"fileServices\",\"tableServices\",\"queueServices\"],\"defaultValue\":[\"storageAccounts\",\"blobServices\",\"fileServices\",\"tableServices\",\"queueServices\"],\"metadata\":{\"description\":\"List of Storage services to deploy\",\"displayName\":\"Storage services to deploy\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"StorageDelete\":{\"value\":\"[parameters('StorageDelete')]\"},\"StorageRead\":{\"value\":\"[parameters('StorageRead')]\"},\"StorageWrite\":{\"value\":\"[parameters('StorageWrite')]\"},\"Transaction\":{\"value\":\"[parameters('Transaction')]\"},\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('diagnosticsSettingNameToUse')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"resourceName\":{\"value\":\"[field('name')]\"},\"servicesToDeploy\":{\"value\":\"[parameters('servicesToDeploy')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"StorageDelete\":{\"type\":\"string\"},\"StorageRead\":{\"type\":\"string\"},\"StorageWrite\":{\"type\":\"string\"},\"Transaction\":{\"type\":\"string\"},\"diagnosticsSettingNameToUse\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"},\"servicesToDeploy\":{\"type\":\"array\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"condition\":\"[contains(parameters('servicesToDeploy'), 'blobServices')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/default/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('StorageRead')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('StorageWrite')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('StorageDelete')]\"}],\"metrics\":[{\"category\":\"Transaction\",\"enabled\":\"[parameters('Transaction')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/blobServices/providers/diagnosticSettings\"},{\"apiVersion\":\"2017-05-01-preview\",\"condition\":\"[contains(parameters('servicesToDeploy'), 'fileServices')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/default/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('StorageRead')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('StorageWrite')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('StorageDelete')]\"}],\"metrics\":[{\"category\":\"Transaction\",\"enabled\":\"[parameters('Transaction')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/fileServices/providers/diagnosticSettings\"},{\"apiVersion\":\"2017-05-01-preview\",\"condition\":\"[contains(parameters('servicesToDeploy'), 'tableServices')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/default/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('StorageRead')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('StorageWrite')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('StorageDelete')]\"}],\"metrics\":[{\"category\":\"Transaction\",\"enabled\":\"[parameters('Transaction')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/tableServices/providers/diagnosticSettings\"},{\"apiVersion\":\"2017-05-01-preview\",\"condition\":\"[contains(parameters('servicesToDeploy'), 'queueServices')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/default/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('StorageRead')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('StorageWrite')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('StorageDelete')]\"}],\"metrics\":[{\"category\":\"Transaction\",\"enabled\":\"[parameters('Transaction')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/queueServices/providers/diagnosticSettings\"},{\"apiVersion\":\"2017-05-01-preview\",\"condition\":\"[contains(parameters('servicesToDeploy'), 'storageAccounts')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"metrics\":[{\"category\":\"Transaction\",\"enabled\":\"[parameters('Transaction')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"anyof\":[{\"equals\":\"True\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"True\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
          "schema_version": 0,
          "attributes": {
            "description": "Secure your blob and file storage account with greater flexibility using customer-managed keys. When you specify a customer-managed key, that key is used to protect and control access to the key that encrypts your data. Using customer-managed keys provides additional capabilities to control rotation of the key encryption key or cryptographically erase data.",
            "display_name": "Storage accounts should use customer-managed key for encryption",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.3\"}",
            "name": "6fac406b-40ca-413b-bf8e-0bf964659c25",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"not\":{\"equals\":\"Microsoft.Keyvault\",\"field\":\"Microsoft.Storage/storageAccounts/encryption.keySource\"}}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access on a Batch account improves security by ensuring your Batch account can only be accessed from a private endpoint. Learn more about disabling public network access at https://docs.microsoft.com/azure/batch/private-connectivity.",
            "display_name": "Public network access should be disabled for Batch accounts",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Batch\",\"version\":\"1.0.0\"}",
            "name": "74c5a0ae-5e48-4738-b093-65e23a060488",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Batch/batchAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Batch/batchAccounts/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
          "schema_version": 0,
          "attributes": {
            "description": "Enable resource logs for public IP addressess in diagnostic settings to stream to a Log Analytics workspace. Get detailed visibility into attack traffic and actions taken to mitigate DDoS attacks via notifications, reports and flow logs.",
            "display_name": "Public IP addresses should have resource logs enabled for Azure DDoS Protection",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.1\"}",
            "name": "752154a7-1e0f-45c6-a880-ac75a7e4f648",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The target Log Analytics workspace for the diagnostic settings\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Enable Logs - True or False\",\"displayName\":\"Enable Logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Enable Metrics - True or False\",\"displayName\":\"Enable Metrics\"}},\"profileName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Profile name for the Azure diagnostic settings resource\",\"displayName\":\"Diagnostic setting name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/publicIPAddresses\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"name\":{\"value\":\"[field('name')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat(parameters('logAnalytics'), 'configured for resource logs for ', ': ', parameters('name'))]\"}},\"parameters\":{\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"name\":\"[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DDoSProtectionNotifications\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DDoSMitigationFlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DDoSMitigationReports\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/publicIPAddresses/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('LogsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('MetricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Linux virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all virtual machines in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
            "display_name": "Deploy Dependency agent for Linux virtual machine scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"5.1.0\"}",
            "name": "765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"0001-com-ubuntu-server-focal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"20_04-lts\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\",\"12-sp4-gen2\",\"12-SP5\",\"15\",\"15-SP1\"]}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp5*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"},{\"equals\":\"gen1\",\"field\":\"Microsoft.Compute/imageSKU\"}]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentLinux\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentLinux\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentLinux\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that your CosmosDB account isn't exposed on the public internet. Creating private endpoints can limit exposure of your CosmosDB account. Learn more at: https://docs.microsoft.com/azure/cosmos-db/how-to-configure-private-endpoints#blocking-public-network-access-during-account-creation.",
            "display_name": "Azure Cosmos DB should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Cosmos DB\",\"version\":\"1.0.0\"}",
            "name": "797b37f7-06b8-444c-b1ad-fc62867f335a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.DocumentDB/databaseAccounts/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone can be linked to your virtual network to resolve app configuration instances. Learn more at: https://aka.ms/appconfig/private-endpoint.",
            "display_name": "Configure private DNS zones for private endpoints connected to App Configuration",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"App Configuration\",\"version\":\"1.0.0\"}",
            "name": "7a860e27-9ca2-4fc6-822d-c2d248c300df",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS zone\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"configurationStores\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-azconfig-io\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
          "schema_version": 0,
          "attributes": {
            "description": "Encrypting OS and data disks using customer-managed keys provides more control and greater flexibility in key management. This is a common requirement in many regulatory and industry compliance standards.",
            "display_name": "Both operating systems and data disks in Azure Kubernetes Service clusters should be encrypted by customer-managed keys",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"1.0.1\"}",
            "name": "7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\",\"portalReview\":true}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"False\",\"field\":\"Microsoft.ContainerService/managedClusters/diskEncryptionSetID\"},{\"equals\":\"\",\"field\":\"Microsoft.ContainerService/managedClusters/diskEncryptionSetID\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.",
            "display_name": "MySQL servers should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.4\"}",
            "name": "83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"AzureKeyVault\",\"field\":\"Microsoft.DBforMySQL/servers/keys/serverKeyType\"},{\"field\":\"Microsoft.DBforMySQL/servers/keys/uri\",\"notEquals\":\"\"},{\"exists\":\"true\",\"field\":\"Microsoft.DBforMySQL/servers/keys/uri\"}]},\"type\":\"Microsoft.DBforMySQL/servers/keys\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
          "schema_version": 0,
          "attributes": {
            "description": "Use a customer-managed key to control the encryption of the device unlock password for Azure Data Box. Customer-managed keys also help manage access to the device unlock password by the Data Box service in order to prepare the device and copy data in an automated manner. The data on the device itself is already encrypted at rest with Advanced Encryption Standard 256-bit encryption, and the device unlock password is encrypted by default with a Microsoft managed key.",
            "display_name": "Azure Data Box jobs should use a customer-managed key to encrypt the device unlock password",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Data Box\",\"version\":\"1.0.0\"}",
            "name": "86efb160-8de7-451d-bc08-5d475b0aadae",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy\",\"displayName\":\"Effect\"}},\"supportedSKUs\":{\"type\":\"Array\",\"allowedValues\":[\"DataBox\",\"DataBoxHeavy\"],\"defaultValue\":[\"DataBox\",\"DataBoxHeavy\"],\"metadata\":{\"description\":\"The list of SKUs that support customer-managed key encryption key\",\"displayName\":\"Supported SKUs\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DataBox/jobs\",\"field\":\"type\"},{\"field\":\"Microsoft.Databox/jobs/sku.name\",\"in\":\"[parameters('supportedSKUs')]\"},{\"field\":\"Microsoft.DataBox/jobs/details.keyEncryptionKey.kekType\",\"notEquals\":\"CustomerManaged\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys when you want to securely store any metadata and private data assets of your Stream Analytics jobs in your storage account. This gives you total control over how your Stream Analytics data is encrypted.",
            "display_name": "Azure Stream Analytics jobs should use customer-managed keys to encrypt data",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Stream Analytics\",\"version\":\"1.1.0\"}",
            "name": "87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"SystemAccount\",\"field\":\"Microsoft.StreamAnalytics/streamingJobs/contentStoragePolicy\"},{\"equals\":\"Microsoft.StreamAnalytics/streamingJobs\",\"field\":\"type\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
          "schema_version": 0,
          "attributes": {
            "description": "Upgrade to the latest TLS version. We recommend all customers who are still using API Apps to implement the built-in policy called 'App Service apps should use the latest TLS version', which is scoped to include API apps in addition to Web Apps.",
            "display_name": "[Deprecated]: Latest TLS version should be used in your API App",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"deprecated\":true,\"version\":\"1.0.0-deprecated\"}",
            "name": "8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"*api\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"1.2\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy resource group containing Log Analytics workspace and linked automation account to centralize logs and monitoring. The automation account is aprerequisite for solutions like Updates and Change Tracking.",
            "display_name": "Configure Log Analytics workspace and automation account to centralize logs and monitoring",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
            "parameters": "{\"automationAccountName\":{\"type\":\"String\",\"defaultValue\":\"CentralAutomationAccount\",\"metadata\":{\"description\":\"Provide name for automation account\",\"displayName\":\"automationAccountName\"}},\"automationRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Azure region for automation account\",\"displayName\":\"automationRegion\",\"strongType\":\"location\"}},\"dataRetention\":{\"type\":\"String\",\"defaultValue\":\"30\",\"metadata\":{\"description\":\"Enter the retention period in workspace, can be between 7 to 730 days. Billing is per 30 days at the minimum even when retention is shorter\",\"displayName\":\"dataRetention\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Select DeployIfNotExists to deploy central Log Analytics workspace, Audit or Disable to disable the execution of the policy\",\"displayName\":\"Effect\"}},\"rgName\":{\"type\":\"String\",\"defaultValue\":\"CentralRG\",\"metadata\":{\"description\":\"Provide name for resource group\",\"displayName\":\"rgName\"}},\"sku\":{\"type\":\"String\",\"allowedValues\":[\"pergb2018\",\"Free\",\"Standalone\",\"PerNode\",\"Standard\",\"Premium\"],\"defaultValue\":\"pergb2018\",\"metadata\":{\"description\":\"Select pricing tier. Legacy tiers (Free, Standalone, PerNode, Standard or Premium) are not available to all customers\",\"displayName\":\"sku\"}},\"workspaceName\":{\"type\":\"String\",\"defaultValue\":\"CentralWorkspace\",\"metadata\":{\"description\":\"Provide name for log analytics workspace\",\"displayName\":\"workspaceName\"}},\"workspaceRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enter Azure region for Log Analytics workspace\",\"displayName\":\"workspaceRegion\",\"strongType\":\"location\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"ResourceGroupName\":\"[parameters('rgName')]\",\"deployment\":{\"location\":\"West Central US\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"automationAccountName\":{\"value\":\"[parameters('automationAccountName')]\"},\"automationRegion\":{\"value\":\"[parameters('automationRegion')]\"},\"dataRetention\":{\"value\":\"[parameters('dataRetention')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"},\"sku\":{\"value\":\"[parameters('sku')]\"},\"workspaceName\":{\"value\":\"[parameters('workspaceName')]\"},\"workspaceRegion\":{\"value\":\"[parameters('workspaceRegion')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"automationAccountName\":{\"type\":\"String\"},\"automationRegion\":{\"type\":\"String\"},\"dataRetention\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"},\"sku\":{\"type\":\"String\"},\"workspaceName\":{\"type\":\"String\"},\"workspaceRegion\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"location\":\"[parameters('workspaceRegion')]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"log-analytics\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiversion\":\"2015-10-31\",\"comments\":\"Automation account for Log Analytics workapce\",\"location\":\"[parameters('AutomationRegion')]\",\"name\":\"[parameters('AutomationAccountName')]\",\"properties\":{\"sku\":{\"name\":\"OMS\"}},\"type\":\"Microsoft.Automation/automationAccounts\"},{\"apiVersion\":\"2020-08-01\",\"location\":\"[parameters('workspaceRegion')]\",\"name\":\"[parameters('workspaceName')]\",\"properties\":{\"enableLogAccessUsingOnlyResourcePermissions\":true,\"retentionInDays\":\"[parameters('dataRetention')]\",\"sku\":{\"name\":\"[parameters('sku')]\"}},\"resources\":[{\"apiVersion\":\"2020-08-01\",\"dependsOn\":[\"[parameters('workspaceName')]\",\"[parameters('AutomationAccountName')]\"],\"name\":\"Automation\",\"properties\":{\"resourceId\":\"[concat(subscription().id, '/resourceGroups/', parameters('rgName'), '/providers/Microsoft.Automation/automationAccounts/', parameters('AutomationAccountName'))]\"},\"type\":\"linkedServices\"}],\"type\":\"Microsoft.OperationalInsights/workspaces\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}}},\"deploymentScope\":\"Subscription\",\"existenceScope\":\"resourcegroup\",\"name\":\"[parameters('workspaceName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.OperationalInsights/workspaces\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Dependency agent virtual machine extension. VM insights uses the Dependency agent to collect network metrics and discovered data about processes running on the machine and external process dependencies. See more - https://aka.ms/vminsightsdocs.",
            "display_name": "Configure Dependency agent on Azure Arc enabled Windows servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.0\"}",
            "name": "91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"windows\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled DA extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-11-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('DaExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"settings\":{},\"type\":\"[variables('DaExtensionType')]\",\"typeHandlerVersion\":\"[variables('DaExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"DaExtensionName\":\"DependencyAgentWindows\",\"DaExtensionType\":\"DependencyAgentWindows\",\"DaExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentWindows\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Recovery Services Vaults. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "[Preview]: Configure Azure Recovery Services vaults to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Site Recovery\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "name": "942bd215-1a66-44be-af65-6a1c0318dbe2",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone name required to resolve a private DNS Zone to recovery services vault private endpoint records.\",\"displayName\":\"Private DNS zone Id for Azure Recovery vaults resources\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"AzureSiteRecovery\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-siterecovery\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Protection. For more information, visit https://aka.ms/ddosprotectiondocs.",
            "display_name": "Virtual networks should be protected by Azure DDoS Protection",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Network\",\"version\":\"1.0.1\"}",
            "name": "94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "parameters": "{\"ddosPlan\":{\"type\":\"String\",\"metadata\":{\"description\":\"DDoS Protection Plan resource to be associated to the virtual networks\",\"displayName\":\"DDoS Protection Plan\",\"strongType\":\"Microsoft.Network/ddosProtectionPlans\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Modify\",\"Audit\",\"Disabled\"],\"defaultValue\":\"Modify\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Network/virtualNetworks/enableDdosProtection\",\"notEquals\":true},{\"equals\":\"\",\"field\":\"Microsoft.Network/virtualNetworks/ddosProtectionPlan\"}]}]},\"then\":{\"details\":{\"conflictEffect\":\"audit\",\"operations\":[{\"field\":\"Microsoft.Network/virtualNetworks/enableDdosProtection\",\"operation\":\"addOrReplace\",\"value\":true},{\"field\":\"Microsoft.Network/virtualNetworks/ddosProtectionPlan.id\",\"operation\":\"addOrReplace\",\"value\":\"[parameters('ddosPlan')]\"}],\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"]},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
            "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Backup\",\"version\":\"9.3.0\"}",
            "name": "98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"auditIfNotExists\",\"AuditIfNotExists\",\"deployIfNotExists\",\"DeployIfNotExists\",\"disabled\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"exclusionTagName\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Name of the tag to use for excluding VMs from the scope of this policy. This should be used along with the Exclusion Tag Value parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy.\",\"displayName\":\"Exclusion Tag Name\"}},\"exclusionTagValue\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Value of the tag to use for excluding VMs from the scope of this policy (in case of multiple values, use a comma-separated list). This should be used along with the Exclusion Tag Name parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy.\",\"displayName\":\"Exclusion Tag Values\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"not\":{\"field\":\"[concat('tags[', parameters('exclusionTagName'), ']')]\",\"in\":\"[parameters('exclusionTagValue')]\"}},{\"field\":\"id\",\"notContains\":\"/resourceGroups/databricks-rg-\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notEquals\":\"azureopenshift\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notEquals\":\"AzureDatabricks\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-datacenter-gensecond\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\",\"2022-datacenter-g2\",\"2022-datacenter\",\"2022-datacenter-azure-edition\",\"2022-datacenter-azure-edition-smalldisk\",\"2022-datacenter-azure-edition-core\",\"2022-datacenter-azure-edition-core-smalldisk\",\"2022-datacenter-smalldisk-g2\",\"2022-datacenter-smalldisk\",\"2022-datacenter-core-g2\",\"2022-datacenter-core\",\"2022-datacenter-core-smalldisk-g2\",\"2022-datacenter-core-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sql2019-ws2022\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"sqldev\",\"sqldev-gen2\",\"standard\",\"standard-gen2\"]}]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2019\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-11\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"RHEL-BYOS\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"rhel-lvm77\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"contains\":\"ubuntu\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"*20_04-lts\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04-lts*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"22_04-lts-gen2\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"CentOS-HPC\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"7_9-gen2\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"},\"vmRgName\":{\"value\":\"[resourceGroup().name]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"status\":{\"type\":\"string\",\"value\":\"[concat('Backup enabled successfully for VM:', ' ', parameters('vmName'), 'Backup Vault: ', variables('vaultName'))]\"}},\"parameters\":{\"location\":{\"metadata\":{\"description\":\"Location for VM and Backup vault\"},\"type\":\"string\"},\"vmName\":{\"metadata\":{\"description\":\"Name of Azure Virtual Machines\"},\"type\":\"string\"},\"vmRgName\":{\"metadata\":{\"description\":\"Resource group containing the virtual machines.\"},\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2016-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[variables('vaultName')]\",\"properties\":{},\"sku\":{\"name\":\"Standard\"},\"type\":\"Microsoft.RecoveryServices/vaults\"},{\"apiVersion\":\"2016-12-01\",\"dependsOn\":[\"[resourceId('Microsoft.RecoveryServices/vaults/', variables('vaultName'))]\"],\"location\":\"[parameters('location')]\",\"name\":\"[concat(variables('vaultName'), '/', variables('backupFabric'), '/', variables('v2VmContainer'), concat(parameters('vmRgName'),';',parameters('vmName')), '/', variables('v2Vm'), concat(parameters('vmRgName'),';',parameters('vmName')))]\",\"properties\":{\"policyId\":\"[resourceId('Microsoft.RecoveryServices/vaults/backupPolicies', variables('vaultName'),variables('backupPolicy'))]\",\"protectedItemType\":\"[variables('v2VmType')]\",\"sourceResourceId\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', parameters('vmRgName'), '/providers/Microsoft.Compute/virtualMachines/', parameters('vmName'))]\"},\"type\":\"Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems\"}],\"variables\":{\"backupFabric\":\"Azure\",\"backupPolicy\":\"DefaultPolicy\",\"v2Vm\":\"vm;iaasvmcontainerv2;\",\"v2VmContainer\":\"iaasvmcontainer;iaasvmcontainerv2;\",\"v2VmType\":\"Microsoft.Compute/virtualMachines\",\"vaultName\":\"[take(concat('RSVault-', parameters('location'), '-', guid(resourceGroup().id)),50)]\"}}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\",\"/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b\"],\"type\":\"Microsoft.RecoveryServices/backupprotecteditems\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your Batch account's data. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/Batch-CMK.",
            "display_name": "Azure Batch account should use customer-managed keys to encrypt data",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Batch\",\"version\":\"1.0.1\"}",
            "name": "99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Batch/batchAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Batch/batchAccounts/encryption.keySource\",\"notEquals\":\"Microsoft.KeyVault\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Log Analytics virtual machine extension. VM insights uses the Log Analytics agent to collect the guest OS performance data, and provides insights into their performance. See more - https://aka.ms/vminsightsdocs. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date",
            "display_name": "Configure Log Analytics extension on Azure Arc enabled Linux servers. See deprecation notice below",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.1\"}",
            "name": "9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the agent should be connected to. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"linux\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"OMSAgentForLinux\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"OmsAgentForLinux\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\",\"notEquals\":\"Failed\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
          "schema_version": 0,
          "attributes": {
            "description": "Auditing on your SQL Server should be enabled to track database activities across all databases on the server and save them in an audit log.",
            "display_name": "Auditing on SQL server should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.0\"}",
            "name": "a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"setting\":{\"type\":\"String\",\"allowedValues\":[\"enabled\",\"disabled\"],\"defaultValue\":\"enabled\",\"metadata\":{\"displayName\":\"Desired Auditing setting\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"[parameters('setting')]\",\"field\":\"Microsoft.Sql/auditingSettings.state\"},\"name\":\"default\",\"type\":\"Microsoft.Sql/servers/auditingSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
          "schema_version": 0,
          "attributes": {
            "description": "Use Azure Policy Add-on to manage and report on the compliance state of your Azure Kubernetes Service (AKS) clusters. For more information, see https://aka.ms/akspolicydoc.",
            "display_name": "Deploy Azure Policy Add-on to Azure Kubernetes Service clusters",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"4.1.0\"}",
            "name": "a8eff44f-8c92-45c3-a3fb-9880802d67a7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"clusterName\":{\"value\":\"[field('name')]\"},\"clusterResourceGroupName\":{\"value\":\"[resourceGroup().name]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"clusterName\":{\"type\":\"string\"},\"clusterResourceGroupName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"name\":\"[variables('clusterGetDeploymentName')]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"aksCluster\":{\"type\":\"object\",\"value\":\"[reference(resourceId(parameters('clusterResourceGroupName'), 'Microsoft.ContainerService/managedClusters', parameters('clusterName')), '2021-07-01', 'Full')]\"}},\"resources\":[]}},\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2020-06-01\",\"name\":\"[variables('clusterUpdateDeploymentName')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"aksClusterContent\":{\"value\":\"[reference(variables('clusterGetDeploymentName')).outputs.aksCluster.value]\"},\"aksClusterName\":{\"value\":\"[parameters('clusterName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"aksClusterContent\":{\"type\":\"object\"},\"aksClusterName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-07-01\",\"location\":\"[parameters('aksClusterContent').location]\",\"name\":\"[parameters('aksClusterName')]\",\"properties\":{\"aadProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'aadProfile'), parameters('aksClusterContent').properties.aadProfile, json('null'))]\",\"addonProfiles\":{\"azurepolicy\":{\"enabled\":true}},\"agentPoolProfiles\":\"[if(contains(parameters('aksClusterContent').properties, 'agentPoolProfiles'), parameters('aksClusterContent').properties.agentPoolProfiles, json('null'))]\",\"apiServerAccessProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'apiServerAccessProfile'), parameters('aksClusterContent').properties.apiServerAccessProfile, json('null'))]\",\"autoScalerProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'autoScalerProfile'), parameters('aksClusterContent').properties.autoScalerProfile, json('null'))]\",\"disableLocalAccounts\":\"[if(contains(parameters('aksClusterContent').properties, 'disableLocalAccounts'), parameters('aksClusterContent').properties.disableLocalAccounts, json('null'))]\",\"diskEncryptionSetID\":\"[if(contains(parameters('aksClusterContent').properties, 'diskEncryptionSetID'), parameters('aksClusterContent').properties.diskEncryptionSetID, json('null'))]\",\"dnsPrefix\":\"[parameters('aksClusterContent').properties.dnsPrefix]\",\"enablePodSecurityPolicy\":\"[if(contains(parameters('aksClusterContent').properties, 'enablePodSecurityPolicy'), parameters('aksClusterContent').properties.enablePodSecurityPolicy, json('null'))]\",\"enableRBAC\":\"[if(contains(parameters('aksClusterContent').properties, 'enableRBAC'), parameters('aksClusterContent').properties.enableRBAC, json('null'))]\",\"identityProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'identityProfile'), parameters('aksClusterContent').properties.identityProfile, json('null'))]\",\"kubernetesVersion\":\"[parameters('aksClusterContent').properties.kubernetesVersion]\",\"linuxProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'linuxProfile'), parameters('aksClusterContent').properties.linuxProfile, json('null'))]\",\"networkProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'networkProfile'), parameters('aksClusterContent').properties.networkProfile, json('null'))]\",\"nodeResourceGroup\":\"[parameters('aksClusterContent').properties.nodeResourceGroup]\",\"servicePrincipalProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'servicePrincipalProfile'), parameters('aksClusterContent').properties.servicePrincipalProfile, json('null'))]\",\"windowsProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'windowsProfile'), parameters('aksClusterContent').properties.windowsProfile, json('null'))]\"},\"sku\":\"[parameters('aksClusterContent').sku]\",\"tags\":\"[if(contains(parameters('aksClusterContent'), 'tags'), parameters('aksClusterContent').tags, json('null'))]\",\"type\":\"Microsoft.ContainerService/managedClusters\"}]}},\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"clusterGetDeploymentName\":\"[take(concat('Policy-Get-', parameters('clusterName')), 64)]\",\"clusterUpdateDeploymentName\":\"[take(concat('Policy-Update-', parameters('clusterName')), 64)]\"}}}},\"existenceCondition\":{\"equals\":\"true\",\"field\":\"Microsoft.ContainerService/managedClusters/addonProfiles.azurePolicy.enabled\"},\"name\":\"[field('name')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8\",\"/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064\"],\"type\":\"Microsoft.ContainerService/managedClusters\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to an IoT Hub device provisioning service instance. Learn more at: https://aka.ms/iotdpsvnet.",
            "display_name": "Configure IoT Hub device provisioning instances to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Internet of Things\",\"version\":\"1.0.0\"}",
            "name": "aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"iotDps\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink.azure-devices-provisioning.net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to key vault. Learn more at: https://aka.ms/akvprivatelink.",
            "display_name": "Configure Azure Key Vaults to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"1.0.1\"}",
            "name": "ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"A private DNS zone ID to connect to the private endpoint.\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"vault\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"keyvault-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure SignalR Service resource. Learn more at: https://aka.ms/asrs/privatelink.",
            "display_name": "Deploy - Configure private DNS zones for private endpoints connect to Azure SignalR Service",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"SignalR\",\"version\":\"1.0.0\"}",
            "name": "b0e86710-7fb7-4a6c-a064-32e9b829509e",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"defaultValue\":\"privatelink.service.signalr.net\",\"metadata\":{\"description\":\"Private DNS zone to integrate with private endpoint.\",\"displayName\":\"Private DNS Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"signalr\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-service-signalr-net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links a virtual network to an App Service. Learn more at: https://docs.microsoft.com/azure/app-service/networking/private-endpoint#dns.",
            "display_name": "Configure App Service apps to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"1.0.1\"}",
            "name": "b318f84a-b872-429b-ac6d-a01b96814452",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone to deploy in a new private DNS zone group and link to the private endpoint\",\"displayName\":\"Private Dns Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Web/sites\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"sites\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"websites-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for SQL Databases to stream resource logs to a Log Analytics workspace when any SQL Database which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy - Configure diagnostic settings for SQL Databases to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"4.0.0\"}",
            "name": "b79fa14e-238a-4c2d-b376-442ce508fc84",
            "parameters": "{\"AutomaticTuningEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream AutomaticTuning logs to the Log Analytics workspace - True or False\",\"displayName\":\"AutomaticTuning - Enabled\"}},\"Basic\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Basic metrics to the Log Analytics workspace - True or False\",\"displayName\":\"Basic (metric) - Enabled\"}},\"BlocksEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Blocks logs to the Log Analytics workspace - True or False\",\"displayName\":\"Blocks - Enabled\"}},\"DatabaseWaitStatisticsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream DatabaseWaitStatistics logs to the Log Analytics workspace - True or False\",\"displayName\":\"DatabaseWaitStatistics - Enabled\"}},\"DeadlocksEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Deadlocks logs to the Log Analytics workspace - True or False\",\"displayName\":\"Deadlocks - Enabled\"}},\"ErrorsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Errors logs to the Log Analytics workspace - True or False\",\"displayName\":\"Errors - Enabled\"}},\"InstanceAndAppAdvanced\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream InstanceAndAppAdvanced metrics to the Log Analytics workspace - True or False\",\"displayName\":\"InstanceAndAppAdvanced (metric) - Enabled\"}},\"QueryStoreRuntimeStatisticsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream QueryStoreRuntimeStatistics logs to the Log Analytics workspace - True or False\",\"displayName\":\"QueryStoreRuntimeStatistics - Enabled\"}},\"QueryStoreWaitStatisticsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream QueryStoreWaitStatistics logs to the Log Analytics workspace - True or False\",\"displayName\":\"QueryStoreWaitStatistics - Enabled\"}},\"SQLInsightsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream SQLInsights logs to the Log Analytics workspace - True or False\",\"displayName\":\"SQLInsights - Enabled\"}},\"SQLSecurityAuditEventsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream SQLSecurityAuditEvents logs to the Log Analytics workspace - True or False\",\"displayName\":\"SQLSecurityAuditEvents - Enabled\"}},\"TimeoutsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Timeouts logs to the Log Analytics workspace - True or False\",\"displayName\":\"Timeouts - Enabled\"}},\"WorkloadManagement\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream WorkloadManagement metrics to the Log Analytics workspace - True or False\",\"displayName\":\"WorkloadManagement (metric) - Enabled\"}},\"diagnosticsSettingNameToUse\":{\"type\":\"String\",\"defaultValue\":\"SQLDatabaseDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"Name of the diagnostic settings.\",\"displayName\":\"Setting name\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select the Log Analytics workspace from dropdown list\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},{\"field\":\"name\",\"notEquals\":\"master\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"AutomaticTuningEnabled\":{\"value\":\"[parameters('AutomaticTuningEnabled')]\"},\"Basic\":{\"value\":\"[parameters('Basic')]\"},\"BlocksEnabled\":{\"value\":\"[parameters('BlocksEnabled')]\"},\"DatabaseWaitStatisticsEnabled\":{\"value\":\"[parameters('DatabaseWaitStatisticsEnabled')]\"},\"DeadlocksEnabled\":{\"value\":\"[parameters('DeadlocksEnabled')]\"},\"ErrorsEnabled\":{\"value\":\"[parameters('ErrorsEnabled')]\"},\"InstanceAndAppAdvanced\":{\"value\":\"[parameters('InstanceAndAppAdvanced')]\"},\"QueryStoreRuntimeStatisticsEnabled\":{\"value\":\"[parameters('QueryStoreRuntimeStatisticsEnabled')]\"},\"QueryStoreWaitStatisticsEnabled\":{\"value\":\"[parameters('QueryStoreWaitStatisticsEnabled')]\"},\"SQLInsightsEnabled\":{\"value\":\"[parameters('SQLInsightsEnabled')]\"},\"SQLSecurityAuditEventsEnabled\":{\"value\":\"[parameters('SQLSecurityAuditEventsEnabled')]\"},\"TimeoutsEnabled\":{\"value\":\"[parameters('TimeoutsEnabled')]\"},\"WorkloadManagement\":{\"value\":\"[parameters('WorkloadManagement')]\"},\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('diagnosticsSettingNameToUse')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"AutomaticTuningEnabled\":{\"type\":\"string\"},\"Basic\":{\"type\":\"string\"},\"BlocksEnabled\":{\"type\":\"string\"},\"DatabaseWaitStatisticsEnabled\":{\"type\":\"string\"},\"DeadlocksEnabled\":{\"type\":\"string\"},\"ErrorsEnabled\":{\"type\":\"string\"},\"InstanceAndAppAdvanced\":{\"type\":\"string\"},\"QueryStoreRuntimeStatisticsEnabled\":{\"type\":\"string\"},\"QueryStoreWaitStatisticsEnabled\":{\"type\":\"string\"},\"SQLInsightsEnabled\":{\"type\":\"string\"},\"SQLSecurityAuditEventsEnabled\":{\"type\":\"string\"},\"TimeoutsEnabled\":{\"type\":\"string\"},\"WorkloadManagement\":{\"type\":\"string\"},\"diagnosticsSettingNameToUse\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"SQLInsights\",\"enabled\":\"[parameters('SQLInsightsEnabled')]\"},{\"category\":\"AutomaticTuning\",\"enabled\":\"[parameters('AutomaticTuningEnabled')]\"},{\"category\":\"QueryStoreRuntimeStatistics\",\"enabled\":\"[parameters('QueryStoreRuntimeStatisticsEnabled')]\"},{\"category\":\"QueryStoreWaitStatistics\",\"enabled\":\"[parameters('QueryStoreWaitStatisticsEnabled')]\"},{\"category\":\"Errors\",\"enabled\":\"[parameters('ErrorsEnabled')]\"},{\"category\":\"DatabaseWaitStatistics\",\"enabled\":\"[parameters('DatabaseWaitStatisticsEnabled')]\"},{\"category\":\"Timeouts\",\"enabled\":\"[parameters('TimeoutsEnabled')]\"},{\"category\":\"Blocks\",\"enabled\":\"[parameters('BlocksEnabled')]\"},{\"category\":\"Deadlocks\",\"enabled\":\"[parameters('DeadlocksEnabled')]\"},{\"category\":\"SQLSecurityAuditEvents\",\"enabled\":\"[parameters('SQLSecurityAuditEventsEnabled')]\"}],\"metrics\":[{\"category\":\"Basic\",\"enabled\":\"[parameters('Basic')]\"},{\"category\":\"InstanceAndAppAdvanced\",\"enabled\":\"[parameters('InstanceAndAppAdvanced')]\"},{\"category\":\"WorkloadManagement\",\"enabled\":\"[parameters('WorkloadManagement')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/servers/databases/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"SQLInsights\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('SQLInsightsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"AutomaticTuning\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('AutomaticTuningEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"QueryStoreRuntimeStatistics\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('QueryStoreRuntimeStatisticsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"QueryStoreWaitStatistics\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('QueryStoreWaitStatisticsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Errors\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('ErrorsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"DatabaseWaitStatistics\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('DatabaseWaitStatisticsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Timeouts\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('TimeoutsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Blocks\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('BlocksEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Deadlocks\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('DeadlocksEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"SQLSecurityAuditEvents\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('SQLSecurityAuditEventsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]}]}},\"equals\":10},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Basic\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('Basic')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]},{\"allOf\":[{\"equals\":\"InstanceAndAppAdvanced\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('InstanceAndAppAdvanced')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]},{\"allOf\":[{\"equals\":\"WorkloadManagement\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('WorkloadManagement')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]}]}},\"equals\":3}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Logic Apps to stream to a regional Log Analytics workspace when any Logic Apps which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Logic Apps to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "b889a06c-ec72-4b03-910a-cb169ee18721",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Logic/workflows\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"WorkflowRuntime\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Logic/workflows/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
          "schema_version": 0,
          "attributes": {
            "description": "Manage encryption at rest of Azure Machine Learning workspace data with customer-managed keys. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/azureml-workspaces-cmk.",
            "display_name": "Azure Machine Learning workspaces should be encrypted with a customer-managed key",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"1.1.0\"}",
            "name": "ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"not\":{\"equals\":\"project\",\"field\":\"kind\"}},{\"not\":{\"equals\":\"enabled\",\"field\":\"Microsoft.MachineLearningServices/workspaces/encryption.status\"}}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Deploy - Configure Azure Event Grid topics to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Grid\",\"version\":\"1.1.0\"}",
            "name": "baf19753-7502-405f-8745-370519b20483",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"deployIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"topic\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"topic-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to a managed disk. Learn more at: https://aka.ms/disksprivatelinksdoc.",
            "display_name": "Configure disk access resources to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Compute\",\"version\":\"1.0.0\"}",
            "name": "bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The private DNS zone name required for managed disks to resolve a private DNS Zone.\",\"displayName\":\"Private DNS Zone ID for managed disks\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Compute/diskAccesses\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"disks\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"diskAccess-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Key Vault to stream to a regional Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Key Vault to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.0\"}",
            "name": "bef3f64c-5290-43b7-85b0-9b254eef4c47",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"matchWorkspace\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":false,\"metadata\":{\"description\":\"Whether to require that the workspace of the diagnostic settings matches the workspace deployed by this policy\",\"displayName\":\"Workspace id must match\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AuditEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzurePolicyEvaluationDetails\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.KeyVault/vaults/providers/diagnosticSettings\"}],\"variables\":{}}}},\"evaluationDelay\":\"AfterProvisioning\",\"existenceCondition\":{\"allOf\":[{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"equals\":\"AuditEvent\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"}]}},\"greaterOrEquals\":1},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*]\",\"where\":{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}},\"greaterOrEquals\":1},{\"anyOf\":[{\"equals\":false,\"value\":\"[parameters('matchWorkspace')]\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Cognitive Services accounts. Learn more at: https://go.microsoft.com/fwlink/?linkid=2110097.",
            "display_name": "Configure Cognitive Services accounts to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Cognitive Services\",\"version\":\"1.0.0\"}",
            "name": "c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The private DNS zone name required for Cognitive Services to resolve a private DNS Zone to your Cognitive Services account.\",\"displayName\":\"Private DNS Zone ID for Cognitive Services account\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"account\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-cognitiveservices-azure-com\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Diagnostic Settings for Recovery Services Vault to stream to Log Analytics workspace for Resource specific categories. If any of the Resource specific categories are not enabled, a new diagnostic setting is created.",
            "display_name": "Deploy Diagnostic Settings for Recovery Services Vault to Log Analytics workspace for resource specific categories.",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Backup\",\"version\":\"1.0.2\"}",
            "name": "c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
            "parameters": "{\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}},\"tagName\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Name of the tag to use for excluding vaults from this policy. This should be used along with the Exclusion Tag Value parameter.\",\"displayName\":\"Exclusion Tag Name\"}},\"tagValue\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Value of the tag to use for excluding vaults from this policy. This should be used along with the Exclusion Tag Name parameter.\",\"displayName\":\"Exclusion Tag Value\"}}}",
            "policy_rule": "{\"if\":{\"allof\":[{\"equals\":\"Microsoft.RecoveryServices/vaults\",\"field\":\"type\"},{\"not\":{\"equals\":\"[parameters('tagValue')]\",\"field\":\"[concat('tags[',parameters('tagName'), ']')]\"}}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"vaultName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat(parameters('logAnalytics'), 'configured for resource logs for ', ': ', parameters('vaultName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\"}},\"parameters\":{\"logAnalytics\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"vaultName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"name\":\"[concat(parameters('vaultName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logAnalyticsDestinationType\":\"Dedicated\",\"logs\":[{\"category\":\"CoreAzureBackup\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupAlerts\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupJobs\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupPolicy\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupProtectedInstance\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupStorage\",\"enabled\":\"true\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.RecoveryServices/vaults/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allof\":[{\"Equals\":6,\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allof\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].Category\",\"in\":[\"CoreAzureBackup\",\"AddonAzureBackupJobs\",\"AddonAzureBackupAlerts\",\"AddonAzureBackupPolicy\",\"AddonAzureBackupStorage\",\"AddonAzureBackupProtectedInstance\"]},{\"equals\":\"True\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].Enabled\"}]}}},{\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\",\"notEquals\":\"\"},{\"equals\":\"Dedicated\",\"field\":\"Microsoft.Insights/diagnosticSettings/logAnalyticsDestinationType\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Batch Account to stream to a regional Log Analytics workspace when any Batch Account which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Batch Account to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.1.0\"}",
            "name": "c84e5349-db6d-4769-805e-e14037dab9b5",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Batch/batchAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ServiceLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AuditLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Batch/batchAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public network access property improves security by ensuring your Azure Database for MySQL flexible servers can only be accessed from a private endpoint. This configuration strictly disables access from any public address space outside of Azure IP range and denies all logins that match IP or virtual network-based firewall rules.",
            "display_name": "Public network access should be disabled for MySQL flexible servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.1.0\"}",
            "name": "c9299215-ae47-4f50-9c54-8a392f68a052",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/flexibleServers\",\"field\":\"type\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.delegatedSubnetResourceId\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.privateDnsZoneResourceId\"},{\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private DNS provides a reliable, secure DNS service to manage and resolve domain names in a virtual network without the need to add a custom DNS solution. You can use private DNS zones to override the DNS resolution by using your own custom domain names for a private endpoint. This policy deploys a private DNS Zone for IoT Hub private endpoints.",
            "display_name": "Deploy - Configure Azure IoT Hubs to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Internet of Things\",\"version\":\"1.1.0\"}",
            "name": "c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"deployIfNotExists\",\"DeployIfNotExists\",\"disabled\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"iotHub\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink.azure-devices.net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\",\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Deploy - Configure Azure Event Grid domains to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Grid\",\"version\":\"1.1.0\"}",
            "name": "d389df0a-e0d7-4607-833c-75a6fdac2c2d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"deployIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"domain\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"domain-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Data Lake Analytics to stream to a regional Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataLakeAnalytics/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Requests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Dependency agent virtual machine extension. VM insights uses the Dependency agent to collect network metrics and discovered data about processes running on the machine and external process dependencies. See more - https://aka.ms/vminsightsdocs.",
            "display_name": "Configure Dependency agent on Azure Arc enabled Linux servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.0\"}",
            "name": "deacecc0-9f84-44d2-bb82-46f32d766d43",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"linux\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled DA extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentLinux\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentLinux\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentLinux\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone can be linked to your virtual network to resolve to Azure Cache for Redis. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Configure Azure Cache for Redis to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Cache\",\"version\":\"1.0.0\"}",
            "name": "e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The resource id of the private DNS zone\",\"displayName\":\"Private DNS Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"redisCache\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-redis-cache-windows-net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machine scale sets as non-compliant if the virtual machine image is not in the list defined and the agent is not installed. The list of OS images is updated over time as support is updated.",
            "display_name": "Dependency agent should be enabled in virtual machine scale sets for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"Centos\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to your Container Registry. Learn more at: https://aka.ms/privatednszone and https://aka.ms/acr/private-link.",
            "display_name": "Configure Container registries to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"1.0.1\"}",
            "name": "e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"A private DNS zone id to connect to the private endpoint. It should be linked to the private endpoint's associated VNET.\",\"displayName\":\"Private DNS Zone id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"registry\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"containerRegistry-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Event Hub namespaces. Learn more at: https://docs.microsoft.com/azure/event-hubs/private-link-service.",
            "display_name": "Configure Event Hub namespaces to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Hub\",\"version\":\"1.0.0\"}",
            "name": "ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"namespace\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"namespace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Machine Learning workspaces. Learn more at: https://docs.microsoft.com/azure/machine-learning/how-to-network-security-overview.",
            "display_name": "Configure Azure Machine Learning workspace to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"1.1.0\"}",
            "name": "ee40564d-486e-4f68-a5ca-7a621edae0fb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"A private DNS zone id to connect to the private endpoint.\",\"displayName\":\"Private DNS Zone id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"secondPrivateDnsZoneId\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"A private DNS zone id to connect to the private endpoint.\",\"displayName\":\"Second Private DNS Zone id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"amlworkspace\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"},\"secondPrivateDnsZoneId\":{\"value\":\"[parameters('secondPrivateDnsZoneId')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"},\"secondPrivateDnsZoneId\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":\"[if(not(empty(parameters('secondPrivateDnsZoneId'))), variables('bothPrivateDnsZoneConfigs'), variables('singlePrivateDnsZoneConfigs') )]\"},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}],\"variables\":{\"bothPrivateDnsZoneConfigs\":[{\"name\":\"amlworkspace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}},{\"name\":\"amlworkspace-secondPrivateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('secondPrivateDnsZoneId')]\"}}],\"singlePrivateDnsZoneConfigs\":[{\"name\":\"amlworkspace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]}}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
          "schema_version": 0,
          "attributes": {
            "description": "Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for App Service apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.",
            "display_name": "App Service apps should use the latest TLS version",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"2.0.1\"}",
            "name": "f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"functionapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"1.2\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Service Bus namespaces. Learn more at: https://docs.microsoft.com/azure/service-bus-messaging/private-link-service.",
            "display_name": "Configure Service Bus namespaces to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Service Bus\",\"version\":\"1.0.0\"}",
            "name": "f0fcf93c-c063-4071-9668-c47474bd3564",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"namespace\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"namespace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to control the encryption at rest of the data stored in Azure Synapse workspaces. Customer-managed keys deliver double encryption by adding a second layer of encryption on top of the default encryption with service-managed keys.",
            "display_name": "Azure Synapse workspaces should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Synapse\",\"version\":\"1.0.0\"}",
            "name": "f7d52b2d-e161-4dfa-a82b-55e564167385",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Synapse/workspaces\",\"field\":\"type\"},{\"exists\":false,\"field\":\"Microsoft.Synapse/workspaces/encryption.cmk.key.name\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
          "schema_version": 0,
          "attributes": {
            "description": "Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for Function apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.",
            "display_name": "Function apps should use the latest TLS version",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"2.0.1\"}",
            "name": "f9d614c5-c173-4d56-95a7-b4437057d193",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"field\":\"kind\"},{\"field\":\"kind\",\"notContains\":\"workflowapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"1.2\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to your Azure Cognitive Search service. Learn more at: https://aka.ms/azure-cognitive-search/inbound-private-endpoints.",
            "display_name": "Configure Azure Cognitive Search services to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Search\",\"version\":\"1.0.0\"}",
            "name": "fbc14a67-53e4-4932-abcc-2049c6706009",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"searchService\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"searchService-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
          "schema_version": 0,
          "attributes": {
            "description": "Enable export to Log Analytics workspace of Microsoft Defender for Cloud data. This policy deploys an export to Log Analytics workspace configuration with your conditions and target workspace on the assigned scope. To deploy this policy on newly created subscriptions, open the Compliance tab, select the relevant non-compliant assignment and create a remediation task.",
            "display_name": "Deploy export to Log Analytics workspace for Microsoft Defender for Cloud data",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
            "management_group_id": null,
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"4.1.0\"}",
            "name": "ffb6f416-7bd2-4488-8828-56585fef2be9",
            "parameters": "{\"alertSeverities\":{\"type\":\"Array\",\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":[\"High\",\"Medium\",\"Low\"],\"metadata\":{\"description\":\"Applicable only for export of security alerts. Determines alert severities. Example: High;Medium;Low;\",\"displayName\":\"Alert severities\"}},\"createResourceGroup\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"If a resource group does not exists in the scope, a new resource group will be created. If the resource group exists and this flag is set to 'true' the policy will re-deploy the resource group. Please note this will reset any Azure Tag on the resource group.\",\"displayName\":\"Create resource group\"}},\"exportedDataTypes\":{\"type\":\"Array\",\"allowedValues\":[\"Security recommendations\",\"Security alerts\",\"Overall secure score\",\"Secure score controls\",\"Regulatory compliance\",\"Overall secure score - snapshot\",\"Secure score controls - snapshot\",\"Regulatory compliance - snapshot\",\"Security recommendations - snapshot\",\"Security findings - snapshot\"],\"defaultValue\":[\"Security recommendations\",\"Security alerts\",\"Overall secure score\",\"Secure score controls\",\"Regulatory compliance\",\"Overall secure score - snapshot\",\"Secure score controls - snapshot\",\"Regulatory compliance - snapshot\",\"Security recommendations - snapshot\",\"Security findings - snapshot\"],\"metadata\":{\"description\":\"The data types to be exported. To export a snapshot (preview) of the data once a week, choose the data types which contains 'snapshot', other data types will be sent in real-time streaming.\",\"displayName\":\"Exported data types\"}},\"isSecurityFindingsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Security findings are results from vulnerability assessment solutions, and can be thought of as 'sub' recommendations grouped into a 'parent' recommendation.\",\"displayName\":\"Include security findings\"}},\"recommendationNames\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Applicable only for export of security recommendations. To export all recommendations, leave this empty. To export specific recommendations, enter a list of recommendation IDs separated by semicolons (';'). Recommendation IDs are available through the Assessments API (https://docs.microsoft.com/rest/api/securitycenter/assessments), or Azure Resource Graph Explorer, choose securityresources and microsoft.security/assessments.\",\"displayName\":\"Recommendation IDs\"}},\"recommendationSeverities\":{\"type\":\"Array\",\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":[\"High\",\"Medium\",\"Low\"],\"metadata\":{\"description\":\"Applicable only for export of security recommendations. Determines recommendation severities. Example: High;Medium;Low;\",\"displayName\":\"Recommendation severities\"}},\"regulatoryComplianceStandardsNames\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Applicable only for export of regulatory compliance. To export all regulatory compliance, leave this empty. To export specific regulatory compliance standards, enter a list of these standards names separated by semicolons (';'). Regulatory compliance standards names are available through the regulatory compliance standards API (https://docs.microsoft.com/rest/api/securitycenter/regulatorycompliancestandards), or Azure Resource Graph Explorer, choose securityresources and microsoft.security/regulatorycompliancestandards.\",\"displayName\":\"Regulatory compliance standards names\"}},\"resourceGroupLocation\":{\"type\":\"String\",\"metadata\":{\"description\":\"The location where the resource group and the export to Log Analytics workspace configuration are created.\",\"displayName\":\"Resource group location\",\"strongType\":\"location\"}},\"resourceGroupName\":{\"type\":\"String\",\"metadata\":{\"description\":\"The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured.\",\"displayName\":\"Resource group name\"}},\"secureScoreControlsNames\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Applicable only for export of secure score controls. To export all secure score controls, leave this empty. To export specific secure score controls, enter a list of secure score controls IDs separated by semicolons (';'). Secure score controls IDs are available through the Secure score controls API (https://docs.microsoft.com/rest/api/securitycenter/securescorecontrols), or Azure Resource Graph Explorer, choose securityresources and microsoft.security/securescores/securescorecontrols.\",\"displayName\":\"Secure Score Controls IDs\"}},\"workspaceResourceId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The Log Analytics workspace of where the data should be exported to.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"Microsoft.OperationalInsights/workspaces\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"ResourceGroupName\":\"[parameters('resourceGroupName')]\",\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"alertSeverities\":{\"value\":\"[parameters('alertSeverities')]\"},\"createResourceGroup\":{\"value\":\"[parameters('createResourceGroup')]\"},\"exportedDataTypes\":{\"value\":\"[parameters('exportedDataTypes')]\"},\"isSecurityFindingsEnabled\":{\"value\":\"[parameters('isSecurityFindingsEnabled')]\"},\"recommendationNames\":{\"value\":\"[parameters('recommendationNames')]\"},\"recommendationSeverities\":{\"value\":\"[parameters('recommendationSeverities')]\"},\"regulatoryComplianceStandardsNames\":{\"value\":\"[parameters('regulatoryComplianceStandardsNames')]\"},\"resourceGroupLocation\":{\"value\":\"[parameters('resourceGroupLocation')]\"},\"resourceGroupName\":{\"value\":\"[parameters('resourceGroupName')]\"},\"secureScoreControlsNames\":{\"value\":\"[parameters('secureScoreControlsNames')]\"},\"workspaceResourceId\":{\"value\":\"[parameters('workspaceResourceId')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"alertSeverities\":{\"type\":\"array\"},\"createResourceGroup\":{\"type\":\"bool\"},\"exportedDataTypes\":{\"type\":\"array\"},\"guidValue\":{\"defaultValue\":\"[newGuid()]\",\"type\":\"string\"},\"isSecurityFindingsEnabled\":{\"type\":\"bool\"},\"recommendationNames\":{\"type\":\"array\"},\"recommendationSeverities\":{\"type\":\"array\"},\"regulatoryComplianceStandardsNames\":{\"type\":\"array\"},\"resourceGroupLocation\":{\"type\":\"string\"},\"resourceGroupName\":{\"type\":\"string\"},\"secureScoreControlsNames\":{\"type\":\"array\"},\"workspaceResourceId\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"condition\":\"[parameters('createResourceGroup')]\",\"location\":\"[parameters('resourceGroupLocation')]\",\"name\":\"[parameters('resourceGroupName')]\",\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2019-10-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('resourceGroupName'))]\"],\"name\":\"[concat('nestedAutomationDeployment', '_', parameters('guidValue'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-01-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('resourceGroupLocation')]\",\"name\":\"ExportToWorkspace\",\"properties\":{\"actions\":[{\"actionType\":\"Workspace\",\"workspaceResourceId\":\"[parameters('workspaceResourceId')]\"}],\"description\":\"Export Microsoft Defender for Cloud data to Log Analytics workspace via policy\",\"isEnabled\":true,\"scopes\":[{\"description\":\"[replace(variables('scopeDescription'),'{0}', subscription().subscriptionId)]\",\"scopePath\":\"[subscription().id]\"}],\"sources\":\"[variables('sources')]\"},\"tags\":{},\"type\":\"Microsoft.Security/automations\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('resourceGroupName')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"alertSeveritiesLength\":\"[length(parameters('alertSeverities'))]\",\"alertSeveritiesLengthIfEmpty\":\"[if(equals(variables('alertSeveritiesLength'), 0), 1, variables('alertSeveritiesLength'))]\",\"alertSeverityMap\":{\"High\":\"high\",\"Low\":\"low\",\"Medium\":\"medium\"},\"customRuleSetsForRegulatoryComplianceObj\":{\"copy\":[{\"count\":\"[variables('regulatoryComplianceStandardsNamesLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('regulatoryComplianceStandardsNamesLength'), 0), json('null'), parameters('regulatoryComplianceStandardsNames')[copyIndex('ruleSetsForRegulatoryCompliancArr')])]\",\"operator\":\"Contains\",\"propertyJPath\":\"id\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForRegulatoryCompliancArr\"}]},\"customRuleSetsForSecureScoreControlsObj\":{\"copy\":[{\"count\":\"[variables('secureScoreControlsLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('secureScoreControlsNamesLength'), 0), json('null'), parameters('secureScoreControlsNames')[copyIndex('ruleSetsForSecureScoreControlsArr')])]\",\"operator\":\"Equals\",\"propertyJPath\":\"name\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForSecureScoreControlsArr\"}]},\"customRuleSetsForSubAssessmentsObj\":{\"copy\":[{\"count\":\"[variables('recommendationNamesLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('recommendationNamesLength'), 0), json('null'), replace(variables('subAssessmentRuleExpectedValue'),'{0}', parameters('recommendationNames')[copyIndex('ruleSetsForSubAssessmentsArr')]))]\",\"operator\":\"Contains\",\"propertyJPath\":\"id\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForSubAssessmentsArr\"}]},\"dataTypeMap\":{\"Overall secure score\":\"SecureScores\",\"Overall secure score - snapshot\":\"SecureScoresSnapshot\",\"Regulatory compliance\":\"RegulatoryComplianceAssessment\",\"Regulatory compliance - snapshot\":\"RegulatoryComplianceAssessmentSnapshot\",\"Secure score controls\":\"SecureScoreControls\",\"Secure score controls - snapshot\":\"SecureScoreControlsSnapshot\",\"Security alerts\":\"Alerts\",\"Security findings - snapshot\":\"SubAssessmentsSnapshot\",\"Security recommendations\":\"Assessments\",\"Security recommendations - snapshot\":\"AssessmentsSnapshot\"},\"exportedDataTypesLength\":\"[length(parameters('exportedDataTypes'))]\",\"exportedDataTypesLengthIfEmpty\":\"[if(equals(variables('exportedDataTypesLength'), 0), 1, variables('exportedDataTypesLength'))]\",\"recommendationNamesLength\":\"[length(parameters('recommendationNames'))]\",\"recommendationNamesLengthIfEmpty\":\"[if(equals(variables('recommendationNamesLength'), 0), 1, variables('recommendationNamesLength'))]\",\"recommendationSeveritiesLength\":\"[length(parameters('recommendationSeverities'))]\",\"recommendationSeveritiesLengthIfEmpty\":\"[if(equals(variables('recommendationSeveritiesLength'), 0), 1, variables('recommendationSeveritiesLength'))]\",\"regulatoryComplianceStandardsNamesLength\":\"[length(parameters('regulatoryComplianceStandardsNames'))]\",\"regulatoryComplianceStandardsNamesLengthIfEmpty\":\"[if(equals(variables('regulatoryComplianceStandardsNamesLength'), 0), 1, variables('regulatoryComplianceStandardsNamesLength'))]\",\"ruleSetsForAlertsObj\":{\"copy\":[{\"count\":\"[variables('alertSeveritiesLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[variables('alertSeverityMap')[parameters('alertSeverities')[mod(copyIndex('ruleSetsForAlertsArr'),variables('alertSeveritiesLengthIfEmpty'))]]]\",\"operator\":\"Equals\",\"propertyJPath\":\"Severity\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForAlertsArr\"}]},\"ruleSetsForAssessmentsObj\":{\"copy\":[{\"count\":\"[mul(variables('recommendationNamesLengthIfEmpty'),variables('recommendationSeveritiesLengthIfEmpty'))]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('recommendationNamesLength'),0),'Microsoft.Security/assessments',parameters('recommendationNames')[mod(div(copyIndex('ruleSetsForAssessmentsArr'),variables('totalRuleCombinationsForOneRecommendationName')),variables('recommendationNamesLength'))])]\",\"operator\":\"Contains\",\"propertyJPath\":\"[if(equals(variables('recommendationNamesLength'),0),'type','name')]\",\"propertyType\":\"string\"},{\"expectedValue\":\"[parameters('recommendationSeverities')[mod(div(copyIndex('ruleSetsForAssessmentsArr'),variables('totalRuleCombinationsForOneRecommendationSeverity')),variables('recommendationSeveritiesLength'))]]\",\"operator\":\"Equals\",\"propertyJPath\":\"properties.metadata.severity\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForAssessmentsArr\"}]},\"ruleSetsForSecureRegulatoryComplianceObj\":\"[if(equals(variables('regulatoryComplianceStandardsNamesLength'), 0), json('null'), variables('customRuleSetsForRegulatoryComplianceObj').ruleSetsForRegulatoryCompliancArr)]\",\"ruleSetsForSecureScoreControlsObj\":\"[if(equals(variables('secureScoreControlsNamesLength'), 0), json('null'), variables('customRuleSetsForSecureScoreControlsObj').ruleSetsForSecureScoreControlsArr)]\",\"ruleSetsForSubAssessmentsObj\":\"[if(equals(variables('recommendationNamesLength'), 0), json('null'), variables('customRuleSetsForSubAssessmentsObj').ruleSetsForSubAssessmentsArr)]\",\"ruleSetsMap\":{\"Overall secure score\":null,\"Overall secure score - snapshot\":null,\"Regulatory compliance\":\"[variables('ruleSetsForSecureRegulatoryComplianceObj')]\",\"Regulatory compliance - snapshot\":\"[variables('ruleSetsForSecureRegulatoryComplianceObj')]\",\"Secure score controls\":\"[variables('ruleSetsForSecureScoreControlsObj')]\",\"Secure score controls - snapshot\":\"[variables('ruleSetsForSecureScoreControlsObj')]\",\"Security alerts\":\"[variables('ruleSetsForAlertsObj').ruleSetsForAlertsArr]\",\"Security findings - snapshot\":\"[variables('ruleSetsForSubAssessmentsObj')]\",\"Security recommendations\":\"[variables('ruleSetsForAssessmentsObj').ruleSetsForAssessmentsArr]\",\"Security recommendations - snapshot\":\"[variables('ruleSetsForAssessmentsObj').ruleSetsForAssessmentsArr]\"},\"scopeDescription\":\"scope for subscription {0}\",\"secureScoreControlsLengthIfEmpty\":\"[if(equals(variables('secureScoreControlsNamesLength'), 0), 1, variables('secureScoreControlsNamesLength'))]\",\"secureScoreControlsNamesLength\":\"[length(parameters('secureScoreControlsNames'))]\",\"sources\":\"[if(equals(parameters('isSecurityFindingsEnabled'),bool('true')),variables('sourcesWithSubAssessments'),variables('sourcesWithoutSubAssessments').sources)]\",\"sourcesWithSubAssessments\":\"[concat(variables('subAssessmentSource'),variables('sourcesWithoutSubAssessments').sources)]\",\"sourcesWithoutSubAssessments\":{\"copy\":[{\"count\":\"[variables('exportedDataTypesLengthIfEmpty')]\",\"input\":{\"eventSource\":\"[variables('dataTypeMap')[parameters('exportedDataTypes')[copyIndex('sources')]]]\",\"ruleSets\":\"[variables('ruleSetsMap')[parameters('exportedDataTypes')[copyIndex('sources')]]]\"},\"name\":\"sources\"}]},\"subAssessmentRuleExpectedValue\":\"/assessments/{0}/\",\"subAssessmentSource\":[{\"eventSource\":\"SubAssessments\",\"ruleSets\":\"[variables('ruleSetsForSubAssessmentsObj')]\"}],\"totalRuleCombinationsForOneRecommendationName\":\"[variables('recommendationSeveritiesLengthIfEmpty')]\",\"totalRuleCombinationsForOneRecommendationSeverity\":1}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":true,\"field\":\"Microsoft.Security/automations/isEnabled\"},{\"count\":{\"field\":\"Microsoft.Security/automations/sources[*]\"},\"equals\":\"[if(parameters('isSecurityFindingsEnabled'),add(length(parameters('exportedDataTypes')),1),length(parameters('exportedDataTypes')))]\"},{\"count\":{\"name\":\"dataType\",\"value\":\"[parameters('exportedDataTypes')]\",\"where\":{\"count\":{\"field\":\"Microsoft.Security/automations/sources[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Assessments\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security recommendations\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"Alerts\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security alerts\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScores\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Overall secure score\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScoreControls\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Secure score controls\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"RegulatoryComplianceAssessment\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Regulatory compliance\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScoresSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Overall secure score - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScoreControlsSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Secure score controls - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"RegulatoryComplianceAssessmentSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Regulatory compliance - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"AssessmentsSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security recommendations - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SubAssessmentsSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security findings - snapshot\",\"value\":\"[current('dataType')]\"}]}]}},\"equals\":1}},\"equals\":\"[length(parameters('exportedDataTypes'))]\"}]},\"existenceScope\":\"resourcegroup\",\"name\":\"ExportToWorkspace\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Security/automations\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "data",
      "type": "azurerm_policy_set_definition",
      "name": "external_lookup",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a",
          "schema_version": 0,
          "attributes": {
            "description": "Legacy - Enable Azure Monitor for the virtual machines (VMs) in the specified scope (management group, subscription or resource group). Takes Log Analytics workspace as parameter. Use the new initiative named: Enable Azure Monitor for VMs with Azure Monitoring Agent(AMA)",
            "display_name": "Legacy - Enable Azure Monitor for VMs",
            "id": "/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.1\"}",
            "name": "55f3eceb-5573-4f18-9695-226972c6d74a",
            "parameters": "{\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Windows OS to add to scope\"}},\"logAnalytics_1\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {
                  "logAnalytics": "[parameters('logAnalytics_1')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Windows_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {
                  "listOfImageIdToInclude": "[parameters('listOfImageIdToInclude_windows')]",
                  "logAnalytics": "[parameters('logAnalytics_1')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Windows_VM_Deploy"
              },
              {
                "parameter_values": "{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {
                  "logAnalytics": "[parameters('logAnalytics_1')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Linux_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {
                  "listOfImageIdToInclude": "[parameters('listOfImageIdToInclude_linux')]",
                  "logAnalytics": "[parameters('logAnalytics_1')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Linux_VM_Deploy"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Windows_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {
                  "listOfImageIdToInclude": "[parameters('listOfImageIdToInclude_windows')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Windows_VM_Deploy"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Linux_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}}",
                "parameters": {
                  "listOfImageIdToInclude": "[parameters('listOfImageIdToInclude_linux')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Linux_VM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {
                  "listOfImageIdToInclude_linux": "[parameters('listOfImageIdToInclude_linux')]",
                  "listOfImageIdToInclude_windows": "[parameters('listOfImageIdToInclude_windows')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
                "policy_group_names": [],
                "reference_id": "LogAnalytics_OSImage_Audit"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {
                  "listOfImageIdToInclude_linux": "[parameters('listOfImageIdToInclude_linux')]",
                  "listOfImageIdToInclude_windows": "[parameters('listOfImageIdToInclude_windows')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07",
                "policy_group_names": [],
                "reference_id": "DependencyAgent_OSImage_Audit"
              }
            ],
            "policy_definitions": "[{\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Windows_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Windows_VM_Deploy\"},{\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Linux_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Linux_VM_Deploy\"},{\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Windows_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Windows_VM_Deploy\"},{\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Linux_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Linux_VM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\",\"policyDefinitionReferenceId\":\"LogAnalytics_OSImage_Audit\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07\",\"policyDefinitionReferenceId\":\"DependencyAgent_OSImage_Audit\"}]",
            "policy_type": "BuiltIn",
            "timeouts": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad",
          "schema_version": 0,
          "attributes": {
            "description": "Legacy - Enable Azure Monitor for the Virtual Machine Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Use the new initiative named: Enable Azure Monitor for VMSS with Azure Monitoring Agent(AMA). Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
            "display_name": "Legacy - Enable Azure Monitor for Virtual Machine Scale Sets",
            "id": "/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.2\"}",
            "name": "75714362-cae7-409e-9b99-a8e5075b7fad",
            "parameters": "{\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Windows OS to add to scope\"}},\"logAnalytics_1\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {
                  "listOfImageIdToInclude": "[parameters('listOfImageIdToInclude_windows')]",
                  "logAnalytics": "[parameters('logAnalytics_1')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Windows_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {
                  "listOfImageIdToInclude": "[parameters('listOfImageIdToInclude_linux')]",
                  "logAnalytics": "[parameters('logAnalytics_1')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Linux_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {
                  "listOfImageIdToInclude": "[parameters('listOfImageIdToInclude_windows')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Windows_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}}",
                "parameters": {
                  "listOfImageIdToInclude": "[parameters('listOfImageIdToInclude_linux')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Linux_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {
                  "listOfImageIdToInclude_linux": "[parameters('listOfImageIdToInclude_linux')]",
                  "listOfImageIdToInclude_windows": "[parameters('listOfImageIdToInclude_windows')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
                "policy_group_names": [],
                "reference_id": "LogAnalytics_OSImage_VMSS_Audit"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {
                  "listOfImageIdToInclude_linux": "[parameters('listOfImageIdToInclude_linux')]",
                  "listOfImageIdToInclude_windows": "[parameters('listOfImageIdToInclude_windows')]"
                },
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
                "policy_group_names": [],
                "reference_id": "DependencyAgent_OSImage_VMSS_Audit"
              }
            ],
            "policy_definitions": "[{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Windows_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Linux_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Windows_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Linux_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\",\"policyDefinitionReferenceId\":\"LogAnalytics_OSImage_VMSS_Audit\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10\",\"policyDefinitionReferenceId\":\"DependencyAgent_OSImage_VMSS_Audit\"}]",
            "policy_type": "BuiltIn",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    }
  ],
  "check_results": null
}
